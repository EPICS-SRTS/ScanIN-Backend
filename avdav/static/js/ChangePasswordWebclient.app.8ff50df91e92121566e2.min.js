webpackJsonp([3],{252:function(s,o,t){"use strict";s.exports=function(s){var o=t(182);if(o.getUserRole()===Enums.UserRole.NormalUser){var n=t(253);return n.init(s),{start:function(s){n.ShowSingleMailChangePasswordInCommonSettings&&s.run("SettingsWebclient","registerSettingsTabSection",[function(){return t(254)},"common","common"])},getChangePasswordPopup:function(){return t(255)},isChangePasswordButtonAllowed:function(s,o){return!n.ShowSingleMailChangePasswordInCommonSettings||s>1}}}return null}},253:function(s,o,t){"use strict";var n=t(2),e=t(181);s.exports={ShowSingleMailChangePasswordInCommonSettings:!1,init:function(s){var o=s.ChangePasswordWebclient;n.isEmpty(o)||(this.ShowSingleMailChangePasswordInCommonSettings=e.pBool(o.ShowSingleMailChangePasswordInCommonSettings,this.ShowSingleMailChangePasswordInCommonSettings))}}},254:function(s,o,t){"use strict";function n(){this.oSingleMailAccount=null,this.showChangePasswordButton=r.observable(!1),this.init()}var e=t(2),r=t(44),i=t(42),a=t(191),h=i.run("ChangePasswordWebclient","getChangePasswordPopup");t(253);n.prototype.ViewTemplate="ChangePasswordWebclient_ChangeSingleMailAccountPasswordView",n.prototype.init=function(){var s=i.run("MailWebclient","getAccountList",[]),o=function(){1===s.collection().length?(this.oSingleMailAccount=s.collection()[0],this.showChangePasswordButton(!0)):(this.oSingleMailAccount=null,this.showChangePasswordButton(!1))}.bind(this);s&&e.isFunction(s.collection)&&(o(),s.collection.subscribe(o))},n.prototype.changePassword=function(){this.oSingleMailAccount&&a.showPopup(h,[{iAccountId:this.oSingleMailAccount.id(),sModule:"Mail",bHasOldPassword:!0}])},s.exports=new n},255:function(s,o,t){"use strict";function n(){w.call(this),this.currentPassword=i.observable(""),this.newPassword=i.observable(""),this.confirmPassword=i.observable(""),this.accountId=i.observable(""),this.hasOldPassword=i.observable(!1),this.oParams=null}var e=t(2),r=t(1),i=t(44),a=t(184),h=t(179),c=t(256),u=t(190),l=t(185),d=t(187),w=t(193);e.extendOwn(n.prototype,w.prototype),n.prototype.PopupTemplate="ChangePasswordWebclient_ChangePasswordPopup",n.prototype.onOpen=function(s){this.currentPassword(""),this.newPassword(""),this.confirmPassword(""),this.accountId(s.iAccountId),this.hasOldPassword(s.bHasOldPassword),this.oParams=s},n.prototype.change=function(){var s=r.trim(this.newPassword()),o=r.trim(this.confirmPassword());c.checkPassword(s,o)&&this.sendChangeRequest()},n.prototype.sendChangeRequest=function(){var s={AccountId:this.accountId(),CurrentPassword:r.trim(this.currentPassword()),NewPassword:r.trim(this.newPassword())},o={Module:this.oParams.sModule,Method:"ChangePassword"};u.send(this.oParams.sModule,"ChangePassword",s,this.onUpdatePasswordResponse,this),u.abortAndStopSendRequests(o)},n.prototype.onUpdatePasswordResponse=function(s,o){s.Result===!1?(l.showErrorByCode(s,a.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_NOT_SAVED")),u.startSendRequests()):s.Result&&s.Result.RefreshToken?(r.cookie("AuthToken",s.Result.RefreshToken,{expires:30}),h.clearAndReloadLocation(!0,!1)):(this.hasOldPassword()?d.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")):d.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_SET")),this.closePopup(),r.isFunction(this.oParams.fAfterPasswordChanged)&&this.oParams.fAfterPasswordChanged())},s.exports=new n},256:function(s,o,t){"use strict";var n=t(2),e=t(187),r={};r.checkIfFieldsEmpty=function(s,o){var t=n.find(s,function(s){return""===s()});return!t||(o&&e.showError(o),t.focused(!0),!1)},r.checkPassword=function(s,o){var n=t(184),r=t(43),i=!1;return o!==s?e.showError(n.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):r.PasswordMinLength>0&&s.length<r.PasswordMinLength?e.showError(n.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",r.PasswordMinLength)):!r.PasswordMustBeComplex||s.match(/([0-9])/)&&s.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?i=!0:e.showError(n.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE")),i},s.exports=r}});