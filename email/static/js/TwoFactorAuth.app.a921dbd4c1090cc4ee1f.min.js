webpackJsonp([23],{415:function(t,o,e){"use strict";var s=e(2),i=e(182),n=e(184),r=e(416);t.exports=function(t){return r.init(t),{start:function(t){t.run("SettingsWebclient","registerSettingsTab",[function(){return e(417)},r.HashModuleName,n.i18n("TWOFACTORAUTH/LABEL_SETTINGS_TAB")]),i.subscribeEvent("StandardLoginFormWebclient::ConstructView::after",function(t){var o=t.View,i=e(191),n=e(419);o&&(o.onSystemLoginResponse=function(t,o){t.Result&&t.Result.TwoFactorAuth&&t.Result.TwoFactorAuth.UserId?i.showPopup(n,[s.bind(this.onSystemLoginResponseBase,this),t.Result.TwoFactorAuth.UserId]):this.onSystemLoginResponseBase(t,o)})})}}}},416:function(t,o,e){"use strict";var s=e(44),i=e(2),n=e(181);t.exports={ServerModuleName:"TwoFactorAuth",HashModuleName:"two-factor-auth",EnableTwoFactorAuth:s.observable(!0),init:function(t){var o=i.extend({},t[this.ServerModuleName]||{},t.TwoFactorAuth||{});i.isEmpty(o)||this.EnableTwoFactorAuth(n.pBool(o.EnableTwoFactorAuth,this.EnableTwoFactorAuth()))}}},417:function(t,o,e){"use strict";function s(){p.call(this,u.ServerModuleName),this.isEnabledTwoFactorAuth=n.observable(u.EnableTwoFactorAuth()),this.isPasswordVerified=n.observable(!1),this.isShowSecret=n.observable(!1),this.isValidatingPin=n.observable(!1),this.QRCodeSrc=n.observable(""),this.secret=n.observable(""),this.pin=n.observable("")}var i=e(2),n=e(44),r=e(187),h=e(184),a=e(42),p=a.run("SettingsWebclient","getAbstractSettingsFormViewClass"),u=e(416),c=e(191),l=e(418),w=e(190);i.extendOwn(s.prototype,p.prototype),s.prototype.ViewTemplate="TwoFactorAuth_TwoFactorAuthSettingsFormView",s.prototype.confirmePassword=function(){c.showPopup(l,[i.bind(this.onConfirmePassword,this),"EnableTwoFactorAuth"])},s.prototype.onConfirmePassword=function(t){t&&t.Result&&t.Result.Secret&&t.Result.QRcode&&(this.QRCodeSrc(t.Result.QRcode),this.secret(t.Result.Secret),this.isShowSecret(!0))},s.prototype.validatePin=function(){this.isValidatingPin(!0),w.send("TwoFactorAuth","TwoFactorAuthSave",{Pin:this.pin(),Secret:this.secret()},this.onValidatingPinResponse,this)},s.prototype.onValidatingPinResponse=function(t){this.isValidatingPin(!1),t&&t.Result?(this.QRCodeSrc(""),this.secret(""),this.pin(""),this.isShowSecret(!1),this.isEnabledTwoFactorAuth(!0)):r.showError(h.i18n("TWOFACTORAUTH/ERROR_WRONG_PIN"))},s.prototype.disable=function(){c.showPopup(l,[i.bind(function(){this.QRCodeSrc(""),this.secret(""),this.pin(""),this.isShowSecret(!1),this.isEnabledTwoFactorAuth(!1)},this),"DisableTwoFactorAuth"])},t.exports=new s},418:function(t,o,e){"use strict";function s(){a.call(this),this.onConfirm=null,this.password=n.observable(""),this.inPropgress=n.observable(!1),this.action=""}var i=e(2),n=e(44),r=e(187),h=e(184),a=e(193),p=e(190);i.extendOwn(s.prototype,a.prototype),s.prototype.PopupTemplate="TwoFactorAuth_ConfirmPasswordPopup",s.prototype.onOpen=function(t,o){this.onConfirm=t,this.action=o},s.prototype.verifyPassword=function(){this.inPropgress(!0),p.send("TwoFactorAuth",this.action,{Password:this.password()},this.onGetVerifyResponse,this)},s.prototype.onGetVerifyResponse=function(t){var o=t.Result;o?(i.isFunction(this.onConfirm)&&this.onConfirm(t),this.closePopup(),this.password("")):r.showError(h.i18n("TWOFACTORAUTH/ERROR_WRONG_PASSWORD")),this.inPropgress(!1)},t.exports=new s},419:function(t,o,e){"use strict";function s(){a.call(this),this.onConfirm=null,this.pin=n.observable(""),this.inPropgress=n.observable(!1),this.UserId=null,this.pinFocused=n.observable(!1)}var i=e(2),n=e(44),r=e(187),h=e(184),a=e(193),p=e(190);i.extendOwn(s.prototype,a.prototype),s.prototype.PopupTemplate="TwoFactorAuth_VerifyTokenPopup",s.prototype.onOpen=function(t,o){this.onConfirm=t,this.UserId=o,this.pinFocused(!0)},s.prototype.verifyPin=function(){this.inPropgress(!0),p.send("TwoFactorAuth","VerifyPin",{Pin:this.pin(),UserId:this.UserId},this.onGetVerifyResponse,this)},s.prototype.onGetVerifyResponse=function(t){var o=t.Result;o?(i.isFunction(this.onConfirm)&&this.onConfirm(t),this.closePopup(),this.pin("")):(r.showError(h.i18n("TWOFACTORAUTH/ERROR_WRONG_PIN")),this.pin("")),this.inPropgress(!1)},t.exports=new s}});